{{ block "posts-refresh" . }}
<div id="posts-refresh" class="mb-6 flex items-center gap-4">
    <button 
      hx-post="/posts/refresh" 
      hx-swap="outerHTML" 
      hx-target="#posts-refresh"
      class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"
    >
      Refresh Posts
    </button>

    {{ if .LastRefresh }}
      <span class="text-gray-400 text-sm">Last refreshed: {{ .LastRefresh }}</span>
    {{ end }}
  </div>
{{ end }}

{{ block "posts-search" . }}
  <div class="mb-4">
    <input
      type="search"
      name="search"
      placeholder="Begin typing to search posts..."
      hx-post="/search"
      hx-trigger="input changed delay:250ms, keyup[key=='Enter']"
      hx-target="#posts"
      hx-indicator=".htmx-indicator"
      class="w-full px-4 py-2 bg-dark-lighter border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-100 placeholder-gray-400"
    /> 

    <span class="htmx-indicator text-gray-400 text-sm mt-2 block">
      Searching...
    </span>
  </div>
{{ end }}

{{ block "saved-post" . }}
  <button hx-delete="/saved-posts/{{ .ID }}" hx-swap="outerHTML" class="text-blue-500 hover:text-blue-400">ðŸ’™</button>
{{ end }}

{{ block "save-post" . }}
  <button hx-post="/saved-posts/{{ .ID }}" hx-swap="outerHTML" class="text-blue-500 hover:text-blue-400">â™¡</button>
{{ end }}

{{ block "post" . }}
<div id="post-{{ .ID }}" class="post py-6">
    <div class="flex justify-between items-start mb-2">
      <a href="/feeds/{{ .FeedID }}" class="text-sm text-gray-400 hover:text-gray-300 transition-colors block">{{ .FeedName }}</a>

      <div class="flex items-center gap-2">

      <span class="text-sm text-gray-400 block">
          {{ .PublishedAt.Format "January 2, 2006" }}
      </span>

        {{ if .IsSaved }}
          {{ template "saved-post" . }}
        {{ else }}
          {{ template "save-post" . }}
        {{ end }}

        <button hx-post="/read-posts/{{ .ID }}" hx-swap="outerHTML" class="text-blue-500 hover:text-blue-400"></button>
      </div>
    </div>

    <a hx-post="/read-posts/{{ .ID }}" hx-swap="outerHTML" hx-target="#post-{{ .ID }}" onClick="window.open('{{ .Link }}', '_blank')" class="cursor-pointer text-xl font-semibold text-blue-400 hover:text-blue-300 hover:underline transition-all flex-1 mb-2 block">{{ .Title }}</a>
    <p class="text-gray-300">{{ .Description }}</p>
</div>
{{ end }}

{{ block "posts-list" . }}
<div id="posts">
    {{ if .Posts }}
        {{ range .Posts }}
            {{ template "post" . }}
        {{ end }}
    {{ else }}
        {{ if .Query }}
            <p class="text-gray-400 text-center py-8">No posts found for "{{ .Query }}".</p>
        {{ else }}
            <p class="text-gray-400 text-center py-8">No posts found.</p>
        {{ end }}
    {{ end }}
</div>
{{ end }}

{{ block "oob-posts" . }}
<div hx-swap-oob="beforeSwap" id="posts">
  {{ range .Posts }}
    {{ template "post" . }}
  {{ end }}
</div>
{{ end }}
